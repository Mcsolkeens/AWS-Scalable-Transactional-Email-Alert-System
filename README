AWS Scalable -Transactional-EmailAlert System

# ğŸ’¬ AWS Transactional Email Alert System

This project demonstrates a **serverless architecture** that decouples email notification from a core banking application using **Amazon SQS, Lambda, and SES**.

---

## ğŸš€ Project Overview

A core banking system triggers transactional email alerts (e.g. deposits, withdrawals). Instead of directly using SMTP(or any email gatewa y) (which risks failure when local logs/storage overflow), we offload email processing using AWS-native services.

### ğŸ“¦ Tech Stack

* **Amazon SQS** â€“ Queue for email payloads
* **AWS Lambda** â€“ Processes messages from SQS and sends emails
* **Amazon SES** â€“ Sends high-deliverability transactional emails
* **CloudWatch** â€“ Logs and observability

---

##Architecture Flow

[Core App] â†’ [SQS] â†’ [Lambda] â†’ [SES] â†’ [Customer Email]

## ğŸ”¨ Setup Steps

### 1. **Create SQS Queue**

* Standard queue named `give it a situable name`
* No FIFO needed unless strict ordering is required

### 2. **Create Lambda Function**

* Triggered by the SQS queue
* Reads message, extracts recipient, subject, and body
* Uses Boto3 to send email via SES

### 3. **Configure SES**

> SES requires domain/email **verification** to prevent spam and spoofing.

* Use a **personal email** (e.g. Gmail, Yahoo) or a **registered domain**
* In **sandbox mode**, SES can only send to verified recipients
* For production access, submit a request to AWS

### 4. **Send Message via Core App**

A Python script (`core_app_sqs.py`)- (see repo for details of python script) sends a message like:

```
### DETAILED STEP BY STEP IMPLEMENTATION

 Weâ€™ll:

1. **Set up AWS resources**
2. **Write Python client code to send transactions**
3. **Write a Lambda function to process messages**
4. **Test the system end-to-end**

You'll learn how to:

* Set up **SQS**, **Lambda**, and **SES**
* Send messages to a queue
* Trigger a Lambda function
* Format a message
* Send emails with SES

---

## ğŸ¯ Project Goal

When a user makes a transaction (like a deposit or withdrawal), the app sends the details to **SQS**, a **Lambda** picks it up, formats a message, and sends an email using **SES**.

---

## ğŸ§° TOOLS USED

* AWS Services: **SQS**, **Lambda**, **SES**
* Language: **Python 3.8+**
* Environment: AWS Console + local machine
* Libraries: `boto3` (Python AWS SDK)

---

## ğŸ—‚ï¸ STEP 1: PROJECT STRUCTURE

Create a folder structure:

```
emailalert/
â”‚
â”œâ”€â”€ core_app_sqs.py     # Client app (runs locally)
â”œâ”€â”€ lambda_to_ses.py      # Lambda handler (runs on AWS)
```

---

## ğŸ”‘ STEP 2: AWS SETUP (MANUAL VIA CONSOLE)

Letâ€™s create all the necessary AWS resources.

### âœ… A. Create an SQS Queue

1. Go to AWS Console > **SQS**
2. Click **â€œCreate queueâ€**
3. Choose **Standard Queue**
4. Name it: `transaction-events-queue`
5. Keep defaults; click **Create Queue**
---

### âœ… B. Create and Verify an SES Email Address

1. Go to AWS Console > **SES**
2. Click **Verified Identities**
3. Click **â€œCreate Identityâ€**
4. Choose **Email Address**, enter: `your-email@example.com`
5. Check your inbox and verify it by clicking the link---

### âœ… C. Create a Lambda Function

1. Go to AWS Console > **Lambda**

2. Click **â€œCreate Functionâ€**

3. Name it: `give appropriate name`

4. Runtime: **Python 3.8** or higher

5. Click **Create Function**

6. In the Lambda function:

   * Under "Code", replace `lambda_to_ses.py` with code from the next step (we'll get to that).
   * Click **Deploy**.

###  D. Add SQS Trigger to Lambda

1. In the Lambda dashboard â†’ go to **â€œConfigurationâ€ > Triggers**
2. Click **â€œAdd Triggerâ€**
3. Choose **SQS**, select your queue
4. Click **Add**

This tells AWS to invoke the Lambda when a message is sent to SQS.

---

### âœ… E. Add Permissions (IAM Role)

Lambda needs permissions to:

* Read SQS messages
* Send emails via SES

#### Do this:

1. Go to **IAM > Roles**
2. Find the role attached to your Lambda (usually starts with `lambda-`)
3. Attach the following inline policy:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "sqs:ReceiveMessage",
        "sqs:DeleteMessage",
        "sqs:GetQueueAttributes"
      ],
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": "ses:SendEmail",
      "Resource": "*"
    }
  ]
}
```

 Done â€” Lambda can now poll SQS and send emails via SES.

## ğŸ§‘â€ğŸ’» STEP 3: LAMBDA FUNCTION CODE

Paste this code refer to "lamda_to_ses.py" in repo into your Lambda in the AWS Console.

ğŸ§  This function:

* Parses the SQS message
* Formats the email
* Sends it with SES

---

## ğŸ§‘â€ğŸ’» STEP 4: CLIENT SCRIPT TO SEND MESSAGE TO SQS

Run this code/script on VScode or any terminal "core_app_sqs.py" see files in repo 
This will send a json file with payload to the queue for lamda to consume
```

You should see:

```
Message sent to SQS. Message ID: abc123...
```
Email sent to customer@example.com
```

### Check Email

Check your inbox (use your SES-verified recipient email). The email should say:

```
Your account has been credited with $150.00.
```

ğŸ‰ **SUCCESS!**

---

## ğŸ§ª TRY MORE TESTS

Try other values:

* Change `"credit"` to `"debit"`
* Use different amounts
* Test invalid values (like missing fields) to see error handling in logs

---

## âœ… OUTPUTS & DATA FLOW SUMMARY

### Input:

From `send_transaction.py`

```json
{
  "email": "customer@example.com",
  "type": "credit",
  "amount": 150.0
}
```

### Flow:

```
[Local Python Script] 
      â†“
[SQS Queue] â† message sent
      â†“
[AWS Lambda] â† auto-triggered
      â†“
Formats message + sends email using SES
      â†“
[Customer Email Inbox]
```

### Expected Output:

Email with:

```
Subject: Transaction Alert
Body: Your account has been credited with $150.00.
```

---

## ğŸ§¹ OPTIONAL CLEAN-UP (TO AVOID CHARGES)

* Delete the Lambda function
* Delete the SQS queue
* Remove verified SES identity

---

Would you like me to help you automate this using **Terraform** or **AWS SAM**? Or add error handling, DLQ, or retry logic?


